;(function($){$.fn.extend({layer:function(set){set=jQuery.extend({width:null,height:null,trigger:"click",autoclose:0,title:"",contents:"",poptype:0,addclass:"",id:"",position:"fixed",closeparent:true,confirm:null,confirmback:null,cancel:null,cancelback:null,closeback:null,loadback:null,move:true},set);$(this).live(set.trigger,function(){$(this).mainfunction(set)})},mainfunction:function(set){$("#greybackground").remove();$("body").append("<div id=\"greybackground\"></div>");if(set.closeparent){$(".alertlayer").hide()}var $layerclose="<a href=\"javascript:void(0);\" class=\"close layerclose\">关闭</a>";var $layertitle="";if(set.title!=""){$layertitle="<h3 class=\"layertitle\"><b></b>"+set.title+"</h3>"}var $layerbutton="";if(set.confirm!=null||set.cancel!=null){$layerbutton+="<div class=\"layerinput\">";if(set.confirm!=null){$layerbutton+="<input class=\"layerbutton\" type=\"submit\" name=\"button\" value=\""+set.confirm+"\">"}if(set.cancel!=null){$layerbutton+="<input class=\"layerreset\" type=\"reset\" name=\"button\" value=\""+set.cancel+"\">"}$layerbutton+="</div>"}var $alertlayer="";if(set.poptype==0){var contents=set.contents;if(set.contents==""){contents=$(this).attr("href").replace("#",".")}$alertlayer=$(contents)}else if(set.poptype==1){var $class=$(this).attr("class").replace(/ /g,'')+"layer";if(set.addclass!=""){$class=set.addclass}if($("."+$class).length==0){var html="<div class=\""+$class+"\">";html+="<div class=\"layercontent\"><p class=\"layerloading\">正在加载...</p></div>";html+="</div>";$("body").append(html);$alertlayer=$("."+$class);$alertlayer.children(".layercontent").load(set.contents)}$alertlayer=$("."+$class)}else if(set.poptype==2){var $class=$(this).attr("class").replace(/ /g,'')+"layer";if($("."+$class).length==0){var html="<div class=\""+$class+"\">";html+="<div class=\"layertxt\"><span class=\"layericon\"></span>"+set.contents+"</div>";html+="</div>";$("body").append(html)}$alertlayer=$("."+$class)}if(!$alertlayer.hasClass("alertlayer")){$alertlayer.addClass("alertlayer")}$alertlayer.addClass(set.addclass);if(set.id!=""){$alertlayer.attr("id",set.id)}if($alertlayer.children(".layertitle").length==0){$alertlayer.prepend($layertitle)}if($alertlayer.children(".layerclose").length==0){$alertlayer.prepend($layerclose)}if($alertlayer.children(".layerinput").length==0){$alertlayer.append($layerbutton)}$alertlayer.show();var newwidth=set.width==null?$alertlayer.outerWidth(true):set.width;var newheight=set.height==null?$alertlayer.outerHeight(true):set.height;var winwidth=$(window).width();var winheight=$(window).height();var sleft=$(window).scrollLeft();var _stop=$(window).scrollTop();if(set.position!="absolute"){_stop=0}var left1=sleft+(winwidth-newwidth)/2;var top1=_stop+(winheight-newheight)/2;if(top1<0){top1=0}$alertlayer.css({"width":newwidth,"height":newheight,"left":left1,"top":top1,"position":set.position});if(set.loadback!=null){set.loadback($alertlayer)}if(set.autoclose!=0){setTimeout(function(){layer.close($alertlayer)},parseInt(set.autoclose*1000));$alertlayer.append("<div class=\"layerclosetime\"></div>");autoclosetime(parseInt(set.autoclose))}if(set.confirm!=null){$(".layerbutton").click(function(e){if(set.confirmback!=null){set.confirmback($alertlayer)}else{layer.close($alertlayer)}e.stopImmediatePropagation()})}if(set.cancel!=null){$(".layerreset").click(function(e){if(set.cancelback!=null){set.cancelback($alertlayer)}else{layer.close($alertlayer)}e.stopImmediatePropagation()})}function autoclosetime(time){if(time>0){--time;$(".layerclosetime").html(time+"秒后将关闭！");setTimeout(function(){autoclosetime(time)},1000)}}$(".close").click(function(e){if(set.closeback!=null){set.closeback($alertlayer)}else{layer.close($alertlayer)}});if(set.move){var docheight=$(document).height();var _move=false;var _x,_y;$alertlayer.children("h3").mousedown(function(e){_move=true;_x=e.pageX-parseInt($alertlayer.css("left"));_y=e.pageY-parseInt($alertlayer.css("top"))});$(document).mousemove(function(e){if(_move){var x=e.pageX-_x;var y=e.pageY-_y;if(x<=0){x=0}if(x>winwidth-newwidth){x=winwidth-newwidth-10}if(y<=0){y=0}if(y>docheight-newheight){y=docheight-newheight}$alertlayer.css({top:y,left:x})}}).mouseup(function(){_move=false})}},jieshi:function(opt){opt=jQuery.extend({x:-10,y:-50,p:"left",c:"",mw:"",debug:false},opt);$(this).hover(function(){$("body").append("<div class=\"mousetips\"></div>")},function(){if(!opt.debug){$(".mousetips").remove()}});$(this).mousemove(function(e){var postX=e.pageX;var postY=e.pageY;var txt=$(this).attr("alt");$(".mousetips").addClass(opt.c).html("<i></i>"+txt);if(opt.p=="right"){var wiy=$(window).width();$(".mousetips").css({"right":wiy-postX+opt.x,"top":postY+opt.y,"left":"auto","max-width":opt.mw}).fadeIn("fast")}else{$(".mousetips").css({"left":postX+opt.x,"top":postY+opt.y,"max-width":opt.mw}).fadeIn("fast")}})},inputfocus:function(sc){sc=jQuery.extend({vc:"highlight",fc:"on-focus"},sc);$(this).live("focus",function(){var $this=$(this);$this.addClass(sc.vc).addClass(sc.fc);if($this.val()==$this[0].defaultValue){$this.val("")}}).live("blur",function(){var $this=$(this);$this.removeClass(sc.fc);if($.trim($this.val())==""||$this.val()==$this[0].defaultValue){$this.val($this[0].defaultValue);$this.removeClass(sc.vc)}})},bankinput:function(){var obj=$(this);if(obj.val()!=''){obj.val(obj.val().replace(/\s/g,'').replace(/(\d{4})(?=\d)/g,"$1 "))}obj.live('keyup',function(event){if(!(event.keyCode>=48&&event.keyCode<=57)){this.value=this.value.replace(/\D/g,'')}this.value=this.value.replace(/\s/g,'').replace(/(\d{4})(?=\d)/g,"$1 ")}).bind('blur',function(){this.value=this.value.replace(/\s/g,'').replace(/(\d{4})(?=\d)/g,"$1 ")})}})})(jQuery);var layer={close:function(settings){var alertlayer=".alertlayer";if(settings){alertlayer=settings}var layernum=0;$(".alertlayer").each(function(){if(!$(this).is(":hidden")){layernum++}});if(layernum<=1){$("#greybackground").remove()}$(alertlayer).hide()}}
///////////////////////以上为压缩，不用管/////////////////////////////
